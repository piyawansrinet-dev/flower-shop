<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</title>

<style>
body{
  font-family:sans-serif;
  background:#fff5f8;
  padding:20px;
}
.box{
  max-width:500px;
  margin:auto;
  background:white;
  padding:20px;
  border-radius:15px;
  box-shadow:0 5px 15px rgba(0,0,0,0.1);
}
.item{
  border-bottom:1px solid #eee;
  padding:12px 0;
}
.item:last-child{
  border-bottom:none;
}
.total{
  font-weight:bold;
  text-align:right;
  margin-top:15px;
  font-size:18px;
}
.orderBtn{
  width:100%;
  padding:15px;
  background:#06C755;
  color:white;
  border:none;
  border-radius:30px;
  margin-top:20px;
  font-size:18px;
  cursor:pointer;
}
.removeBtn{
  background:red;
  color:white;
  border:none;
  padding:5px 10px;
  border-radius:10px;
  margin-top:5px;
  font-size:14px;
  cursor:pointer;
}
.empty{
  text-align:center;
  padding:20px;
  color:#888;
}
</style>
</head>

<body>

<div class="box">
<h2>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>

<div id="cartItems"></div>

<div class="total" id="totalPrice"></div>

<button class="orderBtn" onclick="orderLine()">
üí¨ ‡∏™‡∏±‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô LINE
</button>

</div>

<script>

// ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
let cart = JSON.parse(localStorage.getItem("cart")) || [];

function renderCart(){
  const cartDiv = document.getElementById("cartItems");
  const totalDiv = document.getElementById("totalPrice");

  cartDiv.innerHTML = "";

  if(cart.length === 0){
    cartDiv.innerHTML = "<div class='empty'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</div>";
    totalDiv.innerHTML = "";
    return;
  }

  let total = 0;

  cart.forEach((item,index)=>{
    total += item.price * item.qty;

    cartDiv.innerHTML += `
      <div class="item">
        <b>${item.name}</b><br>
        ‡∏£‡∏≤‡∏Ñ‡∏≤ ${item.price} ‡∏ö‡∏≤‡∏ó √ó ${item.qty}<br>
        <button class="removeBtn" onclick="removeItem(${index})">
          ‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        </button>
      </div>
    `;
  });

  totalDiv.innerHTML = "‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: " + total + " ‡∏ö‡∏≤‡∏ó";
}

function removeItem(index){
  cart.splice(index,1);
  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
}

function orderLine(){

  if(cart.length === 0){
    alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤");
    return;
  }

  let message = "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ üå∏\n‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤\n\n";
  let total = 0;

  cart.forEach(item=>{
    message += `- ${item.name} √ó ${item.qty} = ${item.price * item.qty} ‡∏ö‡∏≤‡∏ó\n`;
    total += item.price * item.qty;
  });

  message += `\n‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${total} ‡∏ö‡∏≤‡∏ó`;

  let encoded = encodeURIComponent(message);

  // üî• ‡πÄ‡∏î‡πâ‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ LINE OA ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
  window.location.href =
  "https://line.me/R/oaMessage/@935abhab/?text=" + encoded;

  // ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
  localStorage.removeItem("cart");
}

renderCart();

</script>

</body>
</html>