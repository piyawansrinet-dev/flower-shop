<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</title>
<style>
body{font-family:sans-serif;background:#fef6ff;padding:30px;}
.receipt{
 max-width:450px;
 margin:auto;
 background:white;
 padding:20px;
 border-radius:15px;
 box-shadow:0 5px 15px rgba(0,0,0,0.1);
}
h2{text-align:center;color:#ff69b4;}
hr{border:dashed 1px #ccc;margin:15px 0;}
.total{font-size:18px;font-weight:bold;text-align:right;}
</style>
</head>
<body>

<div class="receipt">
<h2>üßæ ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</h2>

<p><b>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</b> <span id="r_name"></span></p>
<p><b>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</b> <span id="r_phone"></span></p>
<p><b>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</b> <span id="r_address"></span></p>

<hr>

<p class="total">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ‡∏ø199</p>

<p style="text-align:center;">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ üíñ</p>
</div>

<script>

// ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à
document.getElementById("r_name").innerText = localStorage.getItem("name") || "-";
document.getElementById("r_phone").innerText = localStorage.getItem("phone") || "-";

let fullAddress =
  "‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà " + (localStorage.getItem("house") || "") +
  " ‡∏ñ‡∏ô‡∏ô " + (localStorage.getItem("road") || "") +
  " ‡∏ï." + (localStorage.getItem("subdistrict") || "") +
  " ‡∏≠." + (localStorage.getItem("district") || "") +
  " ‡∏à." + (localStorage.getItem("province") || "") +
  " " + (localStorage.getItem("postcode") || "");

document.getElementById("r_address").innerText = fullAddress;

console.log("name:", localStorage.getItem("name"));
console.log("phone:", localStorage.getItem("phone"));
console.log("house:", localStorage.getItem("house"));
console.log("road:", localStorage.getItem("road"));

// ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ Google Sheet
let orderData = {
  id: Date.now(),
  name: localStorage.getItem("name"),
  phone: localStorage.getItem("phone"),
  house: localStorage.getItem("house"),
  road: localStorage.getItem("road"),
  subdistrict: localStorage.getItem("subdistrict"),
  district: localStorage.getItem("district"),
  province: localStorage.getItem("province"),
  postcode: localStorage.getItem("postcode"),
  total: 199,
  status: "‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß",
  tracking: ""
};


/let formData = new FormData();

for (let key in orderData) {
  formData.append(key, orderData[key]);
}

fetch("https://script.google.com/macros/s/AKfycbzUFvvI4SIOsEBxmOcSzp5l4LZIvySYHTgYmdqaClFtAwYU2RniTkykEqAWKToEoErZ/exec", {
  method: "POST",
  body: formData
});


</script>




</body>
</html>
